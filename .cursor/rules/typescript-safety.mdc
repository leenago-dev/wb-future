---
globs: *.ts,*.tsx
description: "TypeScript íƒ€ì… ì•ˆì „ì„± ë° any íƒ€ì… ë°©ì§€"
---

# ğŸ”’ TypeScript íƒ€ì… ì•ˆì „ì„±

## í•µì‹¬ ì›ì¹™

**`any` íƒ€ì…ì€ ì ˆëŒ€ ê¸ˆì§€. í•­ìƒ ëª…ì‹œì ì´ê³  ì•ˆì „í•œ íƒ€ì…ì„ ì‚¬ìš©í•œë‹¤.**

---

## ğŸš« ì ˆëŒ€ ê¸ˆì§€ íŒ¨í„´

### âŒ any íƒ€ì… ì‚¬ìš© ê¸ˆì§€

```typescript
// âŒ ê¸ˆì§€: í•¨ìˆ˜ íŒŒë¼ë¯¸í„°
function processData(data: any) {}

// âŒ ê¸ˆì§€: í•¨ìˆ˜ ë°˜í™˜ íƒ€ì…
function getData(): any {}

// âŒ ê¸ˆì§€: ê°ì²´ ì†ì„±
interface Config {
  settings: any
}

// âŒ ê¸ˆì§€: ë°°ì—´ íƒ€ì…
const items: any[] = []

// âŒ ê¸ˆì§€: íƒ€ì… ë‹¨ì–¸
const result = response as any
```

---

## âœ… í•„ìˆ˜ ëŒ€ì•ˆ

### 1. unknown íƒ€ì… + íƒ€ì… ê°€ë“œ

```typescript
// âœ… ì˜¬ë°”ë¦„: unknown ì‚¬ìš©
function processData(data: unknown) {
  if (typeof data === "object" && data !== null) {
    // íƒ€ì… ê°€ë“œë¡œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
  }
}

// âœ… ì˜¬ë°”ë¦„: íƒ€ì… ê°€ë“œ í•¨ìˆ˜
function isUser(value: unknown): value is User {
  return (
    typeof value === "object" &&
    value !== null &&
    "id" in value &&
    "name" in value
  )
}

// ì‚¬ìš©
if (isUser(data)) {
  console.log(data.name) // íƒ€ì… ì•ˆì „
}
```

### 2. ëª…ì‹œì  íƒ€ì… ì •ì˜

```typescript
// âœ… ì˜¬ë°”ë¦„: ì¸í„°í˜ì´ìŠ¤ ì •ì˜
interface User {
  id: string
  name: string
  email?: string
}

// âœ… ì˜¬ë°”ë¦„: ìœ ë‹ˆì˜¨ íƒ€ì…
type Status = "loading" | "success" | "error"

// âœ… ì˜¬ë°”ë¦„: ì œë„¤ë¦­
interface ApiResponse<T> {
  data: T
  success: boolean
  error?: string
}
```

### 3. Zodë¡œ ëŸ°íƒ€ì„ ê²€ì¦

```typescript
// âœ… ì˜¬ë°”ë¦„: Zod ìŠ¤í‚¤ë§ˆ
import { z } from "zod"

const UserSchema = z.object({
  id: z.string(),
  name: z.string(),
  email: z.string().email().optional(),
})

type User = z.infer<typeof UserSchema>

// ì‚¬ìš©
const result = UserSchema.safeParse(apiData)
if (result.success) {
  const user: User = result.data // íƒ€ì… ì•ˆì „
}
```

### 4. Record íƒ€ì…

```typescript
// âœ… ì˜¬ë°”ë¦„: í‚¤-ê°’ ê°ì²´
const config: Record<string, string> = {}

// âœ… ì˜¬ë°”ë¦„: ë¶€ë¶„ì ìœ¼ë¡œ ì•Œë ¤ì§„ êµ¬ì¡°
const metadata: Record<string, unknown> = {
  customField1: "value",
  customField2: 123,
}
```

---

## ğŸ“‹ ì¼ë°˜ì ì¸ ì‹œë‚˜ë¦¬ì˜¤ í•´ê²°

### API ì‘ë‹µ ì²˜ë¦¬

```typescript
// âŒ ì˜ëª»ë¨
const response: any = await fetch("/api/data")

// âœ… ì˜¬ë°”ë¦„: Zod ê²€ì¦
const ResponseSchema = z.object({
  success: z.boolean(),
  data: z.unknown(),
})

const json = await fetch("/api/data").then((r) => r.json())
const response = ResponseSchema.parse(json)
```

### ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

```typescript
// âŒ ì˜ëª»ë¨
const handleChange = (event: any) => {}

// âœ… ì˜¬ë°”ë¦„: ëª…ì‹œì  ì´ë²¤íŠ¸ íƒ€ì…
const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
  console.log(event.target.value)
}
```

### ì—ëŸ¬ ì²˜ë¦¬

```typescript
// âŒ ì˜ëª»ë¨
catch (error: any) {
  console.error(error.message)
}

// âœ… ì˜¬ë°”ë¦„: unknown + íƒ€ì… ê°€ë“œ
catch (error: unknown) {
  if (error instanceof Error) {
    console.error(error.message)
  } else {
    console.error("ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬:", error)
  }
}
```

### ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë°ì´í„°

```typescript
// âŒ ì˜ëª»ë¨
const libraryResult: any = complexLibrary.getData()

// âœ… ì˜¬ë°”ë¦„: ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ë§Œ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
interface LibraryResult {
  id: string
  data: unknown // ë³„ë„ë¡œ ê²€ì¦
}

const libraryResult = complexLibrary.getData() as LibraryResult

// data í•„ë“œëŠ” ë³„ë„ ê²€ì¦
if (typeof libraryResult.data === "object") {
  // ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
}
```

---

## ğŸ¯ ì œë„¤ë¦­ í™œìš©

```typescript
// âœ… ì œë„¤ë¦­ìœ¼ë¡œ ì¬ì‚¬ìš©ì„± í™•ë³´
interface ApiResponse<TData, TError = never> {
  data: TData
  error?: TError
}

// âœ… ì œì•½ ì¡°ê±´ ì¶”ê°€
function pick<T extends object, K extends keyof T>(
  obj: T,
  keys: readonly K[]
): Pick<T, K> {
  const result = {} as Pick<T, K>
  keys.forEach((key) => {
    result[key] = obj[key]
  })
  return result
}

// âœ… ì˜ë¯¸ìˆëŠ” ì œë„¤ë¦­ ì´ë¦„
function transformArray<TInput, TOutput>(
  items: TInput[],
  transformer: (item: TInput) => TOutput
): TOutput[] {
  return items.map(transformer)
}
```

---

## ğŸ” Discriminated Union (íƒœê·¸ëœ ìœ ë‹ˆì˜¨)

```typescript
// âœ… ìƒíƒœë¥¼ íƒœê·¸ í•„ë“œë¡œ êµ¬ë¶„
type LoadState =
  | { status: "idle" }
  | { status: "loading" }
  | { status: "success"; data: User }
  | { status: "error"; message: string }

function handleState(state: LoadState) {
  switch (state.status) {
    case "idle":
      return <div>ëŒ€ê¸° ì¤‘</div>
    case "loading":
      return <Spinner />
    case "success":
      return <UserProfile user={state.data} />
    case "error":
      return <ErrorMessage message={state.message} />
    default:
      // Exhaustiveness check
      const _exhaustive: never = state
      return _exhaustive
  }
}
```

---

## ğŸ“ ì¸í„°í˜ì´ìŠ¤ ì¤€ìˆ˜ ê·œì¹™

### ë°˜ë“œì‹œ ì¸í„°í˜ì´ìŠ¤ í™•ì¸ í›„ ì ‘ê·¼

```typescript
// âŒ ì˜ëª»ë¨: ì¸í„°í˜ì´ìŠ¤ í™•ì¸ ì—†ì´ ì ‘ê·¼
function extractRoute(response: CancellationFeeResponse) {
  return response.trip_info.segments.map((s) => s.route)
  // ì—ëŸ¬: segments ì†ì„±ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
}

// âœ… ì˜¬ë°”ë¦„: ì¸í„°í˜ì´ìŠ¤ í™•ì¸ í›„ ì‹¤ì œ ì†ì„± ì‚¬ìš©
function extractRoute(response: CancellationFeeResponse) {
  const journey = response.journey || []
  return journey.map((segment) => {
    return segment.flight_info?.route_summary?.join(" â†’ ") || "Unknown"
  })
}
```

### ì˜µì…”ë„ ì²´ì´ë‹ ì‚¬ìš©

```typescript
// âœ… ì•ˆì „í•œ ì¤‘ì²© ì†ì„± ì ‘ê·¼
const routeSummary = segment.flight_info?.route_summary?.join(" â†’ ")

// âœ… null/undefined ê¸°ë³¸ê°’ ì²˜ë¦¬
const tripType = data.trip_info?.trip_type ?? "OW"

// âœ… ë°°ì—´ ì•ˆì „ ì ‘ê·¼
const firstSegment = journey?.[0]
```

---

## âœ… ì»¤ë°‹ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `any` íƒ€ì… ì‚¬ìš© ì—†ìŒ (`grep -r "any" src/` í™•ì¸)
- [ ] ëª¨ë“  í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ì— ëª…ì‹œì  íƒ€ì…
- [ ] `unknown` ì‚¬ìš© ì‹œ íƒ€ì… ê°€ë“œ ì¡´ì¬
- [ ] íƒ€ì… ë‹¨ì–¸ì€ ì•ˆì „í•˜ê³  ëª…ì‹œì 
- [ ] ì™¸ë¶€ ë°ì´í„°ëŠ” Zodë¡œ ê²€ì¦
- [ ] ì˜µì…”ë„ ì²´ì´ë‹ ì‚¬ìš© (`?.`)
- [ ] null/undefinedì— ëŒ€í•œ ê¸°ë³¸ê°’ ì²˜ë¦¬

---

## ğŸ§ª íƒ€ì… ì•ˆì „ì„± ê²€ì¦

```bash
# íƒ€ì… ì²´í¬ ì‹¤í–‰
pnpm run type-check

# Lint ì‹¤í–‰
pnpm run lint

# any ì‚¬ìš© ê²€ìƒ‰
grep -r ": any" src/
grep -r "as any" src/
```

---

## ğŸ“ í•µì‹¬ ì›ì¹™ ìš”ì•½

1. **any ì ˆëŒ€ ê¸ˆì§€** - unknown + íƒ€ì… ê°€ë“œ ì‚¬ìš©
2. **ëª…ì‹œì  íƒ€ì…** - ëª¨ë“  ë³€ìˆ˜ì™€ í•¨ìˆ˜ì— íƒ€ì… ì§€ì •
3. **Zod ê²€ì¦** - ì™¸ë¶€ ë°ì´í„°ëŠ” ëŸ°íƒ€ì„ ê²€ì¦
4. **íƒ€ì… ê°€ë“œ** - unknown ë°ì´í„°ëŠ” ì•ˆì „í•˜ê²Œ ì¢íˆê¸°
5. **ì¸í„°í˜ì´ìŠ¤ ì¤€ìˆ˜** - í•­ìƒ ì‹¤ì œ ì¸í„°í˜ì´ìŠ¤ í™•ì¸ í›„ ì ‘ê·¼

**ëª…ì–¸**: "anyë¥¼ ì‚¬ìš©í•˜ëŠ” ìˆœê°„, TypeScriptë¥¼ JavaScriptë¡œ ë°”ê¾¸ëŠ” ê²ƒì´ë‹¤."

---

## ğŸš¨ ê¸´ê¸‰ ìƒí™© í”„ë¡œí† ì½œ

ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ íƒ€ì…ì´ ë³µì¡í•œ ê²½ìš°:

1. **1ìˆœìœ„**: ë¼ì´ë¸ŒëŸ¬ë¦¬ íƒ€ì… ì •ì˜ í™•ì¸
2. **2ìˆœìœ„**: ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ë§Œ ì¸í„°í˜ì´ìŠ¤ ì‘ì„±
3. **3ìˆœìœ„**: unknown + íƒ€ì… ê°€ë“œ ì‚¬ìš©
4. **ìµœí›„**: any + ìƒì„¸í•œ ì£¼ì„ + TODO íƒœê·¸

```typescript
// ìµœí›„ì˜ ìˆ˜ë‹¨ (í”¼í•  ê²ƒ)
// TODO: external-lib v2.0ì—ì„œ íƒ€ì… ì •ì˜ ê°œì„  ì˜ˆì •
// eslint-disable-next-line @typescript-eslint/no-explicit-any
const temp: any = externalLib.complexMethod()
```

---

## ğŸ“Š ì„±ê³µ ì§€í‘œ

- âœ… í”„ë¡œë•ì…˜ ì½”ë“œì—ì„œ any íƒ€ì… 0ê°œ
- âœ… IntelliSense 100% ì»¤ë²„ë¦¬ì§€
- âœ… ëŸ°íƒ€ì„ íƒ€ì… ì—ëŸ¬ ê°ì†Œ
- âœ… ê°œë°œì ê²½í—˜ í–¥ìƒ
- âœ… ì½”ë“œ ìœ ì§€ë³´ìˆ˜ì„± ê°œì„ 

**ì•½ì†**: any íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  í•­ìƒ ì²´ê³„ì ì¸ íƒ€ì… ì•ˆì „ì„± í”„ë¡œì„¸ìŠ¤ë¥¼ ë”°ë¥¸ë‹¤.
